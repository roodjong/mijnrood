{% set pageTitle = 'Inschrijven' %}
{% extends 'user/layout/base.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet/less" type="text/css" href="{{ asset('assets/style/login.less') }}" />
{% endblock %}

{% block scripts %}
    <script>
        function updateContribution() {
            let other = document.querySelector('.other-amount');
            if (document.querySelector('.choice :checked').value !== 0) {
                other.value = '';
            }
        }
        function updateOtherAmount() {
            let other = document.querySelector('.other-amount');
            if (other.value != '')
            {
                document.querySelector('.choice [value="0"]').checked = true;
            }
        }
        document.addEventListener('change', e => {
            if (e.target.closest) {
                if (e.target.closest('.other-amount')) {
                    updateOtherAmount();
                } else if (e.target.closest('.choices')) {
                    updateContribution();
                }
            }
        })
    </script>
{% endblock %}

{% block body %}
    <div id="center-form-wrapper" class="big-form">

        <img id="logo" src="{{ asset(orgLogo) }}" />

        <span class="center-form-title">
            Inschrijven bij <span class="rood">{{ organisatienaam }}</span>
        </span>

        {% if success %}
            <div class="error">
                Je aanmelding is succesvol verwerkt. Binnenkort zul je een e-mail ontvangen van {{ organisatienaam }} met meer informatie.
            </div>
        {% else %}
            {% if form.vars.submitted and not form.vars.valid %}
                <div class="error">
                    {{ form_errors(form) }}
                </div>
            {% endif %}

            {{ form_start(form) }}
                <div class="form-row">
                    {{ form_label(form.firstName, 'Naam') }}
                    <div class="form-field-group">
                        {{ form_widget(form.firstName, { attr: { class: 'text-input', placeholder: 'Voornaam' } }) }}
                        {{ form_widget(form.lastName, { attr: { class: 'text-input', placeholder: 'Achternaam' } }) }}
                    </div>
                </div>

                {{ form_row(form.email, { attr: { class: 'text-input' } }) }}
                {{ form_row(form.phone, { attr: { class: 'text-input' } }) }}
                {{ form_row(form.dateOfBirth, { attr: { class: 'text-input' } }) }}
                {{ form_row(form.address, { attr: { class: 'text-input' } }) }}
                {{ form_row(form.city, { attr: { class: 'text-input' } }) }}
                {{ form_row(form.postCode, { attr: { class: 'text-input' } }) }}
                {{ form_row(form.preferredDivision, { attr: { class: 'text-input' } }) }}

                <p>
                    Selecteer wat er voor jou van toepassing is:
                </p>
                <div class="choices">
                    {% for option in form.contributionPerPeriodInCents.contributionAmount %}
                        <div class="choice">
                            {{ form_widget(option) }}
                            <div class="choice-text">
                                {{ form_label(option, null, { required: false }) }}
                                {% if option.vars.value == 0 %}
                                    <br />
                                    {{ form_widget(form.contributionPerPeriodInCents.otherAmount, { attr: { class: 'other-amount' } }) }} per kwartaal
                                {% endif %}
                            </div>
                        </div>
                    {% endfor %}
                </div>

                <div class="checkbox">
                    {{ form_widget(form.accept) }}
                    {{ form_label(form.accept) }}
                </div>

                <button class="submit-button" type="submit">Inschrijven</button>
            {{ form_end(form) }}
        {% endif %}
    </div>
{% endblock %}
